
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
         html, body {
            margin: 0;
            padding: 0;
            background: #000;
            font-family: 'Arial', sans-serif;
           width: 100vw;
            height: 100vh;
            overflow: hidden;
            }
        .container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 50px;
            width: 100vw;
            height: 100vh;
            margin: 0;
        }

        .section {
             position: relative;
            width: 100%;
            height: 100%;
        }

        .section-title {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            font-size: 24px;
            font-weight: bold;
            z-index: 10;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        .image-indicator {
            text-align: center;
            margin: 10px 0;
            font-weight: bold;
            color: #333;
            display: none;
        }

        .image-container {
             position: relative;
            width: 100%;
            height: 100%;
            background: #000;
            overflow: hidden;
        }

        .full-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: opacity 0.8s ease;
            z-index: 2;
        }

            .full-image.hidden {
                opacity: 0;
            }
        /* æ°´å¹³åœ–ç‰‡ï¼šç›´æ¢ç¿»è½‰ */
        .flip-strips {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 3;
        }

        .flip-strip {
            position: absolute;
            height: 100%;
            perspective: 800px;
            overflow: hidden;
        }

        .flip-inner {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            transform-style: preserve-3d;
            transition: transform 2.0s cubic-bezier(0.4,0,0.2,1);
            transform: rotateY(0deg);
        }

        .flip-strip.flipping .flip-inner {
            transform: rotateY(180deg) !important;
        }
        .flip-inner, .flip-face img {
          will-change: transform, opacity;
        }
        .flip-face {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            backface-visibility: hidden;
            overflow: hidden;
            background: #000;
            box-shadow: none;
        }

            .flip-face.front img,
            .flip-face.back img {
                height: 100%;
                object-fit: cover;
                position: absolute;
                top: 0;
                box-shadow: none;
            }
      
            .flip-face.back {
                transform: rotateY(180deg);
            }
        /* å‚ç›´åœ–ç‰‡ï¼šæ©«æ¢ç¿»è½‰ */
        .flip-strips-vertical {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 3;
            display: flex;
            flex-direction: column;
        }

        .flip-strip-vertical {
            flex: 1 1 0;
            width: 100%;
            perspective: 800px;
            position: relative;
        }

        .flip-inner-vertical {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            transform-style: preserve-3d;
            transition: transform 1.2s cubic-bezier(0.4,0,0.2,1);
        }

        .flip-strip-vertical.flipping .flip-inner-vertical {
            transform: rotateX(180deg);
        }

        .flip-face-vertical {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            backface-visibility: hidden;
            overflow: hidden;
        }

            .flip-face-vertical.front img,
            .flip-face-vertical.back img {
                width: 100%;
                height: 1200%; /* 12æ¢ï¼Œæ¯æ¢åªé¡¯ç¤º1/12 */
                object-fit: contain;
                position: absolute;
                left: 0;
                background: #000;
            }

            .flip-face-vertical.back {
                transform: rotateX(180deg);
            }
        /* ç•¶åŠ ä¸Š no-animation é¡åˆ¥æ™‚ï¼Œå–æ¶ˆå‹•ç•« */
        .no-animation {
            transition: none !important;
            transform: rotateX(180deg); /* é‚„æ˜¯æœƒç¿»ï¼Œä½†ç¬é–“å®Œæˆ */
        }
        
    </style>
</head>
<body>
    <div class="container">
        <div class="section horizontal-section">
            <div class="section-title"></div>
            <div class="image-indicator" id="horizontalIndicator"></div>
            <div class="image-container" id="horizontalContainer">
                <img class="full-image" id="horizontalFullImage" src="https://dawufa.github.io/WebApplication5/WebApplication5/IMAGES/Eggyolkcake/horizontal01.jpg" alt="æ°´å¹³åœ–ç‰‡ 1">
                <div class="flip-strips" id="horizontalFlipStrips"></div>
            </div>
        </div>

    </div>
    <script>
    window.addEventListener('load', () => {
  // å»¶é²åŸ·è¡Œ â†’ ç­‰ DOM / CSS layout éƒ½è™•ç†å®Œ
  setTimeout(() => {
    initializeStrips();
    setTimeout(() => {
      nextImage('horizontal');
      startAutoPlay();
    }, 500); // å‹•ç•«å»¶å¾Œé–‹å§‹ï¼Œé¿å…é»‘ç•«é¢ + å¡é “
  }, 300); // åˆå§‹åŒ–ä¹Ÿå»¶å¾Œ
});

        // æ°´å¹³åœ–ç‰‡
        const horizontalImages = [
            'https://dawufa.github.io/WebApplication5/WebApplication5/IMAGES/Eggyolkcake/horizontal01.jpg',
            
        ];
        let horizontalIndex = 0;

        // ä½ çµ¦çš„åˆ†å‰²é»ï¼ˆå–®ä½: pxï¼‰
        const splitXs = [0, 0, 153, 695, 1255, 1805, 2365, 2905, 3470, 4025, 4575, 5130, 5695, 6255];
        const stripCount = splitXs.length;
        // å‡è¨­åŸåœ–å¯¬åº¦
        const originalWidth = 6400; // è«‹ä¾å¯¦éš›åœ–ç‰‡å¯¬åº¦èª¿æ•´

        // åˆå§‹åŒ–å‡½æ•¸
        function initializeStrips() {
            const horizontalFlipStrips = document.getElementById('horizontalFlipStrips');
            horizontalFlipStrips.innerHTML = '';
            const container = document.getElementById('horizontalContainer');
            const containerW = container.offsetWidth || container.clientWidth;
            const scale = containerW / originalWidth;
            for (let i = 0; i < stripCount; i++) {
                const strip = document.createElement('div');
                strip.className = 'flip-strip';
                let left, width;
                if (i === 0) {
                    left = 0;
                    width = splitXs[i] * scale;
                } else if (i === stripCount - 1) {
                    left = splitXs[i] * scale;
                    width = containerW - left;
                } else {
                    left = splitXs[i] * scale;
                    width = (splitXs[i + 1] - splitXs[i]) * scale;
                }
                strip.style.left = left + 'px';
                strip.style.width = width + 'px';
                strip.style.position = 'absolute';
                strip.style.height = '100%';
                strip.style.overflow = 'hidden';

                const inner = document.createElement('div');
                inner.className = 'flip-inner';

                // æ­£é¢
                const front = document.createElement('div');
                front.className = 'flip-face front';
                const frontImg = document.createElement('img');
                frontImg.src = horizontalImages[horizontalIndex];
                frontImg.style.position = 'absolute';
                frontImg.style.left = -splitXs[i] * scale + 'px';
                frontImg.style.top = '0';
                frontImg.style.width = containerW + 'px';
                frontImg.style.height = '100%';
                frontImg.style.objectFit = 'cover';
                front.appendChild(frontImg);

                // èƒŒé¢ï¼ˆåˆå§‹åŒ–æ™‚åªæœ‰é»‘è‰²èƒŒæ™¯ï¼Œç„¡åœ–ç‰‡ï¼‰
                const back = document.createElement('div');
                back.className = 'flip-face back';
                inner.appendChild(front);
                inner.appendChild(back);
                strip.appendChild(inner);
                horizontalFlipStrips.appendChild(strip);
            }
            horizontalFlipStrips.classList.remove('active');
        }
        
        // é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function () {
            initializeStrips();

            // ç«‹å³åŸ·è¡Œç¬¬ä¸€æ¬¡å‹•ç•«
            setTimeout(() => {
                nextImage('horizontal');
            }, 1000); // ç­‰å¾…1ç§’å¾ŒåŸ·è¡Œç¬¬ä¸€æ¬¡å‹•ç•«

            // å•Ÿå‹•è‡ªå‹•è¼ªæ’­
            startAutoPlay();
        });

        // è‡ªå‹•è¼ªæ’­åŠŸèƒ½
        function startAutoPlay() {
            setInterval(() => {
                nextImage('horizontal');
            }, 8000); // æ¯8ç§’åŸ·è¡Œä¸€æ¬¡
        }

        function nextImage(type) {
            if (type === 'horizontal') {
                const fullImage = document.getElementById('horizontalFullImage');
                const flipStrips = document.getElementById('horizontalFlipStrips');
                const nextIdx = (horizontalIndex + 1) % horizontalImages.length;
                fullImage.classList.add('hidden');
                flipStrips.classList.add('active');
                const strips = flipStrips.querySelectorAll('.flip-strip');

                // å…ˆæŠŠèƒŒé¢éƒ½è¨­æˆé»‘è‰²ï¼ˆç§»é™¤åœ–ç‰‡ï¼‰
                strips.forEach((strip, i) => {
                    const back = strip.querySelector('.flip-face.back');
                    back.innerHTML = '';
                });

                // åŸ·è¡Œç¿»è½‰å‹•ç•«
                strips.forEach((strip, idx) => {
                   setTimeout(() => {
                        strip.classList.add('flipping');

                        // å¼·åˆ¶è¨­ç½®transformå±¬æ€§
                        const inner = strip.querySelector('.flip-inner');
                        if (inner) {
                            inner.style.transform = 'rotateY(180deg)';
                        }

                        // åœ¨ç¿»è½‰ä¸€åŠæ™‚ï¼ˆ600msï¼‰æ›æˆæ–°åœ–ç‰‡
                        setTimeout(() => {
                            const back = strip.querySelector('.flip-face.back');
                            if (!back) {
                                console.error(`åˆ†å‰² ${idx} æ‰¾ä¸åˆ°backå…ƒç´ `);
                                return;
                            }

                            back.innerHTML = '';
                            const backImg = document.createElement('img');
                            backImg.src = horizontalImages[nextIdx];
                            backImg.style.position = 'absolute';

                            // ä¿®æ­£åœ–ç‰‡å®šä½è¨ˆç®— - ç¢ºä¿æ¯å€‹åˆ†å‰²é¡¯ç¤ºæ­£ç¢ºçš„åœ–ç‰‡éƒ¨åˆ†
                            const container = document.getElementById('horizontalContainer');
                            const containerW = container.offsetWidth || container.clientWidth;
                            const scale = containerW / originalWidth;

                            // è¨ˆç®—é€™å€‹åˆ†å‰²æ‡‰è©²é¡¯ç¤ºçš„åœ–ç‰‡ä½ç½®
                            // æ¯å€‹åˆ†å‰²çš„åœ–ç‰‡leftä½ç½®æ‡‰è©²æ˜¯è² çš„ï¼Œé€™æ¨£æ‰èƒ½é¡¯ç¤ºæ­£ç¢ºçš„éƒ¨åˆ†
                            const imageLeft = -splitXs[idx] * scale;
                            backImg.style.left = imageLeft + 'px';
                            backImg.style.top = '0';
                            backImg.style.width = containerW + 'px';
                            backImg.style.height = '100%';
                            backImg.style.objectFit = 'cover';
                            backImg.style.boxShadow = 'none';
                            backImg.style.zIndex = '1';
                            backImg.style.display = 'block';

                            // èª¿è©¦ä¿¡æ¯
                            console.log(`åˆ†å‰² ${idx}: splitXs[${idx}]=${splitXs[idx]}, scale=${scale}, imageLeft=${imageLeft}, nextImage=${horizontalImages[nextIdx]}, containerW=${containerW}`);

                            // ç«‹å³æ·»åŠ åœ–ç‰‡åˆ°DOM
                            back.appendChild(backImg);
                            console.log(`åˆ†å‰² ${idx} åœ–ç‰‡å·²æ·»åŠ åˆ°DOM`);

                            // å¦‚æœåœ–ç‰‡å·²ç¶“è¼‰å…¥ï¼Œå¼·åˆ¶é‡æ–°æ¸²æŸ“
                            if (backImg.complete) {
                               // å¼·åˆ¶é‡æ–°æ¸²æŸ“
                                backImg.style.display = 'none';
                                backImg.offsetHeight; // è§¸ç™¼é‡æ’
                                backImg.style.display = 'block';
                            }
                        }, 600); // 1.2så‹•ç•«çš„ä¸€åŠ
                    }, idx * 300);

                });

                setTimeout(() => {
                    horizontalIndex = nextIdx;
                    document.getElementById('horizontalIndicator').textContent = `${horizontalIndex + 1} / ${horizontalImages.length}`;
                    // æ›´æ–°å®Œæ•´åœ–ç‰‡ç‚ºä¸‹ä¸€å¼µ
                    fullImage.src = horizontalImages[horizontalIndex];
                    flipStrips.classList.remove('active');
                    setTimeout(() => {
                        fullImage.classList.remove('hidden');
                    }, 100);
                    // é‡ç½®æ­£é¢åœ–ç‰‡èˆ‡å‹•ç•«ç‹€æ…‹
                    strips.forEach((strip, i) => {
                        const frontImg = strip.querySelector('.flip-face.front img');
                        frontImg.src = horizontalImages[horizontalIndex];
                        strip.classList.remove('flipping');

                        // é‡ç½®transformå±¬æ€§
                        const inner = strip.querySelector('.flip-inner');
                        if (inner) {
                            // ğŸ‘‰ åŠ ä¸Š no-animation é¡åˆ¥
                            inner.classList.add('no-animation');

                            // ğŸ‘‰ å¼·åˆ¶è¨­å®š transform
                            inner.style.transform = 'rotateY(0deg)';

                            // ğŸ‘‰ å¼·åˆ¶é‡æ’ï¼ˆè§¸ç™¼å›æµï¼‰
                            void inner.offsetHeight;

                            // ğŸ‘‰ ç§»é™¤ no-animationï¼ˆè®“ä¹‹å¾Œçš„å‹•ç•«é‚„èƒ½å‹•ï¼‰
                            inner.classList.remove('no-animation');
                        }
                    });
                }, stripCount * 300 + 1500);
            } 
          

            }
        
    </script>
</body>
</html>
